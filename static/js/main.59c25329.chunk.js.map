{"version":3,"sources":["component/LangSelector.tsx","garlandLink.ts","component/ResultItem.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["LangSelector","props","size","onChange","value","defaultValue","languages","map","itemLang","Option","key","toUpperCase","garlandLink","item","base","matching","Array","isArray","Url","toLowerCase","indexOf","ID","encodeURI","Name","ResultItem","className","href","target","src","Icon","alt","data-id","data-url","displayedLangs","l","runSearch","term","lang","a","length","console","log","fetch","encodeURIComponent","join","query","ok","json","results","Results","App","useState","search","setSearch","setResults","savedDisplayedLangs","JSON","parse","localStorage","getItem","forEach","includes","push","getSavedLangs","_setDisplayedLangs","savedLang","_setLang","useEffect","Content","offsetTop","checked","e","langs","newLangs","index","splice","setItem","stringify","Group","compact","setLang","Search","onSearch","newValue","autoFocus","style","width","justify","xs","sm","md","lg","result","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.59c25329.chunk.js","sourcesContent":["import {XivLang} from \"../types\";\r\nimport {Select} from \"antd\";\r\nimport React from \"react\";\r\n\r\nexport function LangSelector(props: {\r\n    languages: XivLang[],\r\n    value: XivLang,\r\n    onChange: (lang: XivLang) => void\r\n}) {\r\n    return <Select size={\"large\"} onChange={(value) => {\r\n        props.onChange(value as XivLang);\r\n    }} defaultValue={props.value}>\r\n        {props.languages.map((itemLang) => (\r\n            <Select.Option key={itemLang} value={itemLang}>\r\n                {itemLang.toUpperCase()}\r\n            </Select.Option>\r\n        ))}\r\n    </Select>;\r\n}","import {Result} from \"./types\";\r\n\r\nexport function garlandLink(item: Result): string {\r\n    const base =\"https://garlandtools.org/db/#\";\r\n\r\n    const replaceMatching = [\r\n        \"item\",\r\n        \"quest\",\r\n        \"achievement\",\r\n        \"action\",\r\n        \"status\",\r\n        \"fate\",\r\n        \"leve\",\r\n        [\"ENpcResident\", \"npc\"]\r\n    ];\r\n    for (let matching of replaceMatching) {\r\n        if (Array.isArray(matching)) {\r\n            if (item.Url.toLowerCase().indexOf(`/${matching[0]}`) === 0) {\r\n                return `${base}${matching[1]}/${item.ID}`;\r\n            }\r\n            continue;\r\n        }\r\n\r\n        if (item.Url.toLowerCase().indexOf(`/${matching}`) === 0) {\r\n            return `${base}${matching}/${item.ID}`;\r\n        }\r\n    }\r\n\r\n    return \"https://garlandtools.org/db/#search/\" + encodeURI(item.Name);\r\n}","import React from \"react\";\r\nimport {Result, XivLang} from \"../types\";\r\nimport {garlandLink} from \"../garlandLink\";\r\n\r\nexport function ResultItem(props: {\r\n    displayedLangs: XivLang[],\r\n    item: Result\r\n}) {\r\n    return <div className={\"result\"}>\r\n        <div className=\"left\">\r\n            <a href={garlandLink(props.item)}\r\n               target={\"blank\"}>\r\n                <img src={`https://xivapi.com/${props.item.Icon}`} alt=\"\" className={\"icon\"}/>\r\n            </a>\r\n        </div>\r\n        <div className=\"content\" data-id={props.item.ID} data-url={props.item.Url}>\r\n            {props.displayedLangs.map((l) => {\r\n                return <span key={l}>\r\n                        {l.toUpperCase()} {(props.item as any)[\"Name_\" + l]} <br/>\r\n                    </span>;\r\n            })}\r\n        </div>\r\n    </div>;\r\n}","import React, {useEffect, useState} from 'react';\nimport './App.css';\nimport 'antd/dist/antd.dark.css';\nimport {Affix, Checkbox, Col, Input, Layout, Row} from \"antd\";\nimport {Result, XivLang} from \"./types\";\nimport {LangSelector} from \"./component/LangSelector\";\nimport {ResultItem} from \"./component/ResultItem\";\n\nconst languages: XivLang[] = [\"en\", \"fr\", \"ja\", \"de\"];\n\nasync function runSearch(term: string, lang: XivLang) {\n    if (term.length === 0) {\n        return false;\n    }\n\n    console.log(\"Searching for \" + term);\n\n    const query = await fetch(\"https://xivapi.com/search?language=\" + lang +\n        \"&string=\" + encodeURIComponent(term) +\n        \"&columns=ID,Icon,Url,Name,Name_\" + languages.join(',Name_')\n    );\n    if (!query.ok) {\n        return false;\n    }\n    const results = await query.json();\n    return results.Results as Result[];\n}\n\nlet _savedLangCache: XivLang[] | null = null;\n\n/**\n * Validate possible user input (don't allow an invalid lang)\n */\nfunction getSavedLangs(): XivLang[] {\n    if (_savedLangCache !== null) {\n        return _savedLangCache;\n    }\n\n    const savedDisplayedLangs = JSON.parse(localStorage.getItem(\"displayedLangs\") ?? '[\"en\", \"fr\"]');\n    const displayedLangs: XivLang[] = [];\n    savedDisplayedLangs.forEach((item: string) => {\n        if ((languages as string[]).includes(item)) {\n            displayedLangs.push(item as XivLang);\n        }\n    })\n\n    return displayedLangs;\n}\n\nfunction App() {\n    const [search, setSearch] = useState<string>(\"\");\n    const [results, setResults] = useState<Result[]>([]);\n\n    const [displayedLangs, _setDisplayedLangs] = useState<XivLang[]>(getSavedLangs());\n    const setDisplayedLangs = (langs: XivLang[]) => {\n        localStorage.setItem(\"displayedLangs\", JSON.stringify(langs));\n        _setDisplayedLangs(langs);\n    }\n\n    let savedLang = localStorage.getItem(\"lang\") ?? \"en\";\n    if (!(languages as string[]).includes(savedLang)) {\n        savedLang = \"en\";\n    }\n    const [lang, _setLang] = useState<XivLang>(savedLang as XivLang);\n    const setLang = (lang: XivLang) => {\n        localStorage.setItem(\"lang\", lang);\n        _setLang(lang);\n    }\n\n    useEffect(() => {\n        (async () => {\n            const results = await runSearch(search, lang);\n            if (results) {\n                setResults(results);\n            }\n        })();\n    }, [lang, search]);\n\n    return (\n        <Layout>\n            <Layout.Content>\n                <div className=\"App\">\n                    <Affix offsetTop={0}>\n                        <div className=\"search\">\n                            {languages.map((l) => {\n                                return <label key={l}>\n                                    <Checkbox checked={displayedLangs.includes(l)} onChange={e => {\n                                        let newLangs = [...displayedLangs];\n                                        if (e.target.checked) {\n                                            if (!displayedLangs.includes(l)) {\n                                                newLangs = [...newLangs, l]\n                                            }\n                                        } else {\n                                            const index = displayedLangs.indexOf(l);\n                                            if (index >= 0) {\n                                                newLangs.splice(index, 1);\n                                            }\n                                        }\n                                        setDisplayedLangs(newLangs);\n                                    }}>\n                                        {l.toUpperCase()}\n                                    </Checkbox>\n                                </label>;\n                            })}\n\n                            <Input.Group compact>\n                                <LangSelector languages={languages} value={lang}\n                                              onChange={(value) => setLang(value)}/>\n                                <Input.Search size={\"large\"} onSearch={newValue => {\n                                    setSearch(newValue);\n                                }} autoFocus={true} style={{width: \"80vw\"}}/>\n                            </Input.Group>\n                        </div>\n                    </Affix>\n                    <Row justify={\"center\"}>\n                        <Col xs={24} sm={20} md={16} lg={10}>\n                            <div className={\"results\"}>\n                                {results.map((result: any) => {\n                                    return <ResultItem key={result.ID} displayedLangs={displayedLangs} item={result}/>;\n                                })}\n                            </div>\n                        </Col>\n                    </Row>\n                </div>\n            </Layout.Content>\n        </Layout>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}